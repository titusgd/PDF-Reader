# 文字選取模式說明

## 🎯 三種選取模式

為了讓文字選取更靈活、更精確，系統提供了三種不同的選取模式。

### 1. 🔲 矩形拖曳選取（傳統模式）

**適合**: 選取大段落、多行文字

**使用方式**:
1. 點擊並按住滑鼠左鍵
2. 拖曳形成矩形框
3. 釋放滑鼠完成選取

**優點**:
- ✅ 可以精確控制選取範圍
- ✅ 適合選取大面積文字
- ✅ 視覺化回饋（藍色半透明框）

**缺點**:
- ⚠️ 對於小段文字可能不夠精確
- ⚠️ 需要仔細控制拖曳範圍

**游標**: 十字游標 ✛

---

### 2. 👆 點擊快速選取（新增）

**適合**: 快速選取單詞、短句、一小段文字

**使用方式**:
1. 直接點擊文字所在位置
2. 系統自動選取周圍區域的文字（約 200x30 像素範圍）

**優點**:
- ✅ 操作簡單快速
- ✅ 一鍵選取
- ✅ 適合選取單行或短句

**缺點**:
- ⚠️ 選取範圍固定，無法自訂
- ⚠️ 可能選到不需要的文字

**游標**: 指向手勢 👆

**範圍**: 點擊位置周圍 200x30 像素（可調整）

---

### 3. 📏 兩點定範圍選取（新增）

**適合**: 精確選取任意範圍的文字，從某處到某處

**使用方式**:
1. 點擊選取範圍的起點（左上角）
2. 移動滑鼠（會顯示預覽框）
3. 點擊選取範圍的終點（右下角）
4. 完成選取

**優點**:
- ✅ 最精確的選取方式
- ✅ 可以從任意位置到任意位置
- ✅ 有視覺預覽
- ✅ 適合選取不規則區域

**缺點**:
- ⚠️ 需要點擊兩次（略慢）

**游標**: I 型游標 |

**取消**: 按 ESC 鍵取消當前選取

---

## 🎨 視覺效果

### 矩形拖曳模式
```
拖曳中：藍色虛線框 + 半透明填充
完成：自動擷取文字
```

### 點擊快速模式
```
點擊：立即擷取周圍文字
無視覺效果（即時完成）
```

### 範圍選取模式
```
第一次點擊：顯示藍點
移動滑鼠：顯示預覽框 + "點擊確定範圍"提示
第二次點擊：完成選取並擷取文字
```

## 🔄 切換選取模式

### 在側邊欄切換

1. 打開側邊欄的「翻譯」分頁
2. 在「文字選取模式」區域選擇：
   - ⭕ 矩形拖曳選取（傳統）
   - ⭕ 點擊快速選取
   - ⭕ 兩點定範圍選取
3. 返回 PDF 頁面進行選取

### 狀態列提示

切換模式時，狀態列會顯示當前模式，例如：
```
選取模式: 點擊快速選取
```

## 📋 使用場景

### 場景 1：選取整段 Abstract
**推薦**: 🔲 矩形拖曳選取
```
1. 拖曳從 "Abstract" 開始
2. 到 "Keywords" 結束
3. 釋放滑鼠
```

### 場景 2：只選取一個單詞或短句
**推薦**: 👆 點擊快速選取
```
1. 切換到點擊模式
2. 點擊該單詞
3. 自動選取並翻譯
```

### 場景 3：選取跨行的特定範圍
**推薦**: 📏 兩點定範圍選取
```
1. 切換到範圍選取模式
2. 點擊起點（例如 "Human detection"）
3. 移動到終點（例如 "safety technology"）
4. 點擊確定
```

### 場景 4：選取表格中的儲存格
**推薦**: 📏 兩點定範圍選取 或 👆 點擊快速選取
```
使用兩點模式精確定義儲存格邊界
或使用點擊模式快速選取單一儲存格
```

## ⚙️ 進階調整

### 調整點擊選取的範圍大小

在 `src/pdf_viewer.py` 的 `_handle_point_selection` 方法中：

```python
# 預設值
width = 200  # 寬度（PDF 座標）
height = 30  # 高度

# 可調整為更大範圍
width = 400  # 選取更寬的區域
height = 50  # 選取更高的區域

# 或更小範圍
width = 100  # 只選取單詞
height = 20  # 單行文字
```

## 🎯 最佳實踐

1. **一般文件閱讀**: 使用矩形拖曳（最靈活）
2. **快速查詞**: 使用點擊選取（最快速）
3. **精確選取**: 使用範圍選取（最準確）
4. **混合使用**: 根據不同情況切換模式

## ⌨️ 快捷鍵

| 功能 | 快捷鍵 |
|------|-------|
| 翻譯選取文字 | Ctrl+T |
| 取消範圍選取 | ESC |

## 🔍 技術實作

### 矩形拖曳
```python
mousePressEvent → mouseMoveEvent → mouseReleaseEvent
顯示選取框 → 計算矩形 → 擷取文字
```

### 點擊選取
```python
mousePressEvent → _handle_point_selection
計算周圍矩形（200x30）→ 擷取文字
```

### 範圍選取
```python
第一次 mousePressEvent → 記錄起點 → 顯示預覽
第二次 mousePressEvent → 記錄終點 → 計算矩形 → 擷取文字
```

## 💡 使用技巧

### 技巧 1：快速切換模式

在翻譯分頁直接點選模式，無需額外操作。

### 技巧 2：範圍選取可取消

在範圍選取模式下，如果點錯第一個點：
- 按 **ESC** 鍵取消
- 重新點擊第一個點

### 技巧 3：組合使用

```
1. 先用「點擊模式」快速試探
2. 如果選取不理想，切換到「範圍模式」精確選取
3. 大段落用「矩形模式」
```

### 技巧 4：調整點擊選取範圍

如果點擊選取的範圍太大或太小：
1. 選取後在原文框中手動編輯
2. 或調整程式碼中的 width/height 參數

## 📊 效能對比

| 模式 | 速度 | 精確度 | 操作難度 | 適用場景 |
|------|------|-------|---------|---------|
| 矩形拖曳 | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | 通用 |
| 點擊選取 | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | 單詞/短句 |
| 範圍選取 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 精確選取 |

## 🎓 總結

三種選取模式各有優勢，建議根據實際需求靈活切換：
- **日常使用**: 矩形拖曳（最熟悉）
- **快速翻譯**: 點擊選取（最快）
- **精確控制**: 範圍選取（最準）

---

**版本**: 1.0  
**建立日期**: 2025-11-03  
**狀態**: ✅ 可用

